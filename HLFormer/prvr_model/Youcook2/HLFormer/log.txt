2025-10-29 10:39:09,892 - INFO - Partially Relevant Video Retrieval Training: Youcook2
2025-10-29 10:39:09,893 - INFO - set seed: 0
2025-10-29 10:39:09,944 - INFO - used gpu: 7
2025-10-29 10:39:09,944 - INFO - Hyper Parameter ......
2025-10-29 10:39:09,944 - INFO - {'model_name': 'HLFormer', 'dataset_name': 'Youcook2', 'seed': 0, 'root': '/chenyaofo/chenchuanshen/workspace/HLFormer', 'data_root': '/chenyaofo/chenchuanshen/datasets', 'visual_feature': 'i3d', 'collection': 'Youcook2', 'map_size': 32, 'clip_scale_w': 0.7, 'frame_scale_w': 0.3, 'model_root': '/chenyaofo/chenchuanshen/workspace/HLFormer/prvr_model/Youcook2/HLFormer', 'ckpt_path': '/chenyaofo/chenchuanshen/workspace/HLFormer/prvr_model/Youcook2/HLFormer/ckpt', 'sft_factor': 0.6, 'num_workers': 2, 'no_core_driver': False, 'no_pin_memory': False, 'batchsize': 128, 'lr': 0.0002, 'lr_warmup_proportion': 0.01, 'wd': 0.01, 'margin': 0.2, 'n_epoch': 100, 'max_es_cnt': 10, 'hard_negative_start_epoch': 20, 'hard_pool_size': 20, 'use_hard_negative': False, 'loss_factor': [0.02, 0.04, 0.003, 0.001], 'neg_factor': [0.2, 32, 1], 'curv_init': 1, 'learn_curv_bool': True, 'lorentz_dim': 127, 'eval_query_bsz': 50, 'eval_context_bsz': 100, 'max_desc_l': 120, 'max_ctx_l': 128, 'sub_feat_size': 768, 'q_feat_size': 1024, 'max_position_embeddings': 300, 'hidden_size': 384, 'n_heads': 4, 'input_drop': 0.25, 'drop': 0.25, 'initializer_range': 0.02, 'attention_num': 8, 'pin_memory': True, 'caption_rate': 1.0, 'global_caption': True, 'local_hinge_weight': 0.9, 'local_margin': 0.2, 'global_soft_pos_weight': 0.9, 'soft_pos_margin': 0.1, 'query_or_caption': 3}
2025-10-29 10:39:09,944 - INFO - Loading Data ......
2025-10-29 10:39:10,575 - INFO - Loading Model ......
2025-10-29 10:41:00,275 - INFO - ==========================================================================================================
2025-10-29 10:41:00,276 - INFO - Epoch:  0    New Best Model !!!
2025-10-29 10:41:00,276 - INFO - Average Loss: 4.1803
2025-10-29 10:41:00,276 - INFO - R@1: 0.2
2025-10-29 10:41:00,276 - INFO - R@5: 1.0
2025-10-29 10:41:00,276 - INFO - R@10: 1.9
2025-10-29 10:41:00,276 - INFO - R@100: 22.2
2025-10-29 10:41:00,276 - INFO - Rsum: 25.3
2025-10-29 10:41:00,276 - INFO - Best: R@1: 0.2 R@5: 1.0 R@10: 1.9 R@100: 22.2 Rsum: 25.3
2025-10-29 10:41:00,276 - INFO - ==========================================================================================================
2025-10-29 10:42:41,448 - INFO - ==========================================================================================================
2025-10-29 10:42:41,449 - INFO - Epoch:  1    A Relative Failure Epoch
2025-10-29 10:42:41,449 - INFO - Average Loss: 3.1079
2025-10-29 10:42:41,449 - INFO - R@1: 0.1
2025-10-29 10:42:41,449 - INFO - R@5: 0.8
2025-10-29 10:42:41,449 - INFO - R@10: 1.9
2025-10-29 10:42:41,449 - INFO - R@100: 20.6
2025-10-29 10:42:41,449 - INFO - Rsum: 23.5
2025-10-29 10:42:41,449 - INFO - Best: R@1: 0.2 R@5: 1.0 R@10: 1.9 R@100: 22.2 Rsum: 25.3
2025-10-29 10:42:41,449 - INFO - ==========================================================================================================
2025-10-29 10:44:23,608 - INFO - ==========================================================================================================
2025-10-29 10:44:23,610 - INFO - Epoch:  2    A Relative Failure Epoch
2025-10-29 10:44:23,610 - INFO - Average Loss: 2.5841
2025-10-29 10:44:23,610 - INFO - R@1: 0.2
2025-10-29 10:44:23,610 - INFO - R@5: 0.7
2025-10-29 10:44:23,610 - INFO - R@10: 1.6
2025-10-29 10:44:23,610 - INFO - R@100: 20.7
2025-10-29 10:44:23,610 - INFO - Rsum: 23.2
2025-10-29 10:44:23,610 - INFO - Best: R@1: 0.2 R@5: 1.0 R@10: 1.9 R@100: 22.2 Rsum: 25.3
2025-10-29 10:44:23,610 - INFO - ==========================================================================================================
2025-10-29 10:46:05,011 - INFO - ==========================================================================================================
2025-10-29 10:46:05,014 - INFO - Epoch:  3    A Relative Failure Epoch
2025-10-29 10:46:05,014 - INFO - Average Loss: 2.3192
2025-10-29 10:46:05,014 - INFO - R@1: 0.1
2025-10-29 10:46:05,014 - INFO - R@5: 0.9
2025-10-29 10:46:05,014 - INFO - R@10: 1.8
2025-10-29 10:46:05,014 - INFO - R@100: 21.8
2025-10-29 10:46:05,014 - INFO - Rsum: 24.6
2025-10-29 10:46:05,014 - INFO - Best: R@1: 0.2 R@5: 1.0 R@10: 1.9 R@100: 22.2 Rsum: 25.3
2025-10-29 10:46:05,014 - INFO - ==========================================================================================================
2025-10-29 10:47:46,197 - INFO - ==========================================================================================================
2025-10-29 10:47:46,198 - INFO - Epoch:  4    A Relative Failure Epoch
2025-10-29 10:47:46,198 - INFO - Average Loss: 2.1445
2025-10-29 10:47:46,198 - INFO - R@1: 0.1
2025-10-29 10:47:46,198 - INFO - R@5: 0.9
2025-10-29 10:47:46,198 - INFO - R@10: 2.0
2025-10-29 10:47:46,198 - INFO - R@100: 21.8
2025-10-29 10:47:46,198 - INFO - Rsum: 25.0
2025-10-29 10:47:46,198 - INFO - Best: R@1: 0.2 R@5: 1.0 R@10: 1.9 R@100: 22.2 Rsum: 25.3
2025-10-29 10:47:46,198 - INFO - ==========================================================================================================
2025-10-29 10:48:55,274 - INFO - Partially Relevant Video Retrieval Training: Youcook2
2025-10-29 10:48:55,275 - INFO - set seed: 0
2025-10-29 10:48:55,328 - INFO - used gpu: 7
2025-10-29 10:48:55,329 - INFO - Hyper Parameter ......
2025-10-29 10:48:55,329 - INFO - {'model_name': 'HLFormer', 'dataset_name': 'Youcook2', 'seed': 0, 'root': '/chenyaofo/chenchuanshen/workspace/HLFormer', 'data_root': '/chenyaofo/chenchuanshen/datasets', 'visual_feature': 'i3d', 'collection': 'Youcook2', 'map_size': 32, 'clip_scale_w': 0.7, 'frame_scale_w': 0.3, 'model_root': '/chenyaofo/chenchuanshen/workspace/HLFormer/prvr_model/Youcook2/HLFormer', 'ckpt_path': '/chenyaofo/chenchuanshen/workspace/HLFormer/prvr_model/Youcook2/HLFormer/ckpt', 'sft_factor': 0.6, 'num_workers': 2, 'no_core_driver': False, 'no_pin_memory': False, 'batchsize': 128, 'lr': 0.0002, 'lr_warmup_proportion': 0.01, 'wd': 0.01, 'margin': 0.2, 'n_epoch': 100, 'max_es_cnt': 10, 'hard_negative_start_epoch': 20, 'hard_pool_size': 20, 'use_hard_negative': False, 'loss_factor': [0.02, 0.04, 0.003, 0.001], 'neg_factor': [0.2, 32, 1], 'curv_init': 1, 'learn_curv_bool': True, 'lorentz_dim': 127, 'eval_query_bsz': 50, 'eval_context_bsz': 100, 'max_desc_l': 120, 'max_ctx_l': 128, 'sub_feat_size': 768, 'q_feat_size': 1024, 'max_position_embeddings': 300, 'hidden_size': 384, 'n_heads': 4, 'input_drop': 0.25, 'drop': 0.25, 'initializer_range': 0.02, 'attention_num': 8, 'pin_memory': True, 'caption_rate': 1.0, 'global_caption': True, 'local_hinge_weight': 0.9, 'local_margin': 0.2, 'global_soft_pos_weight': 0.9, 'soft_pos_margin': 0.1, 'query_or_caption': 3}
2025-10-29 10:48:55,329 - INFO - Loading Data ......
2025-10-29 10:48:55,901 - INFO - Loading Model ......
2025-10-29 10:50:15,082 - INFO - ==========================================================================================================
2025-10-29 10:50:15,082 - INFO - Epoch:  0    New Best Model !!!
2025-10-29 10:50:15,082 - INFO - Average Loss: 4.1803
2025-10-29 10:50:15,082 - INFO - R@1: 0.2
2025-10-29 10:50:15,082 - INFO - R@5: 1.0
2025-10-29 10:50:15,082 - INFO - R@10: 1.9
2025-10-29 10:50:15,083 - INFO - R@100: 22.2
2025-10-29 10:50:15,083 - INFO - Rsum: 25.3
2025-10-29 10:50:15,083 - INFO - Best: R@1: 0.2 R@5: 1.0 R@10: 1.9 R@100: 22.2 Rsum: 25.3
2025-10-29 10:50:15,083 - INFO - ==========================================================================================================
2025-10-29 10:56:33,029 - INFO - Partially Relevant Video Retrieval Training: Youcook2
2025-10-29 10:56:33,030 - INFO - set seed: 0
2025-10-29 10:56:33,085 - INFO - used gpu: 7
2025-10-29 10:56:33,085 - INFO - Hyper Parameter ......
2025-10-29 10:56:33,085 - INFO - {'model_name': 'HLFormer', 'dataset_name': 'Youcook2', 'seed': 0, 'root': '/chenyaofo/chenchuanshen/workspace/HLFormer', 'data_root': '/chenyaofo/chenchuanshen/datasets', 'visual_feature': 'i3d', 'collection': 'Youcook2', 'map_size': 32, 'clip_scale_w': 0.7, 'frame_scale_w': 0.3, 'model_root': '/chenyaofo/chenchuanshen/workspace/HLFormer/prvr_model/Youcook2/HLFormer', 'ckpt_path': '/chenyaofo/chenchuanshen/workspace/HLFormer/prvr_model/Youcook2/HLFormer/ckpt', 'sft_factor': 0.6, 'num_workers': 2, 'no_core_driver': False, 'no_pin_memory': False, 'batchsize': 128, 'lr': 0.0002, 'lr_warmup_proportion': 0.01, 'wd': 0.01, 'margin': 0.2, 'n_epoch': 100, 'max_es_cnt': 10, 'hard_negative_start_epoch': 20, 'hard_pool_size': 20, 'use_hard_negative': False, 'loss_factor': [0.02, 0.04, 0.003, 0.001], 'neg_factor': [0.2, 32, 1], 'curv_init': 1, 'learn_curv_bool': True, 'lorentz_dim': 127, 'eval_query_bsz': 50, 'eval_context_bsz': 100, 'max_desc_l': 120, 'max_ctx_l': 128, 'sub_feat_size': 768, 'q_feat_size': 1024, 'max_position_embeddings': 300, 'hidden_size': 384, 'n_heads': 4, 'input_drop': 0.25, 'drop': 0.25, 'initializer_range': 0.02, 'attention_num': 8, 'pin_memory': True, 'caption_rate': 1.0, 'global_caption': True, 'local_hinge_weight': 0.9, 'local_margin': 0.2, 'global_soft_pos_weight': 0.9, 'soft_pos_margin': 0.1, 'query_or_caption': 3}
2025-10-29 10:56:33,097 - INFO - Loading Data ......
2025-10-29 10:56:33,689 - INFO - Loading Model ......
2025-10-29 10:58:22,314 - INFO - ==========================================================================================================
2025-10-29 10:58:22,315 - INFO - Epoch:  0    New Best Model !!!
2025-10-29 10:58:22,315 - INFO - Average Loss: 4.1803
2025-10-29 10:58:22,315 - INFO - R@1: 0.2
2025-10-29 10:58:22,315 - INFO - R@5: 1.0
2025-10-29 10:58:22,315 - INFO - R@10: 1.9
2025-10-29 10:58:22,315 - INFO - R@100: 22.2
2025-10-29 10:58:22,315 - INFO - Rsum: 25.3
2025-10-29 10:58:22,315 - INFO - Best: R@1: 0.2 R@5: 1.0 R@10: 1.9 R@100: 22.2 Rsum: 25.3
2025-10-29 10:58:22,315 - INFO - ==========================================================================================================
2025-10-29 22:07:47,571 - INFO - Partially Relevant Video Retrieval Training: Youcook2
2025-10-29 22:07:47,572 - INFO - set seed: 0
2025-10-29 22:07:47,621 - INFO - used gpu: 5
2025-10-29 22:07:47,621 - INFO - Hyper Parameter ......
2025-10-29 22:07:47,621 - INFO - {'model_name': 'HLFormer', 'dataset_name': 'Youcook2', 'seed': 0, 'root': '/chenyaofo/chenchuanshen/workspace/HLFormer', 'data_root': '/chenyaofo/chenchuanshen/datasets', 'visual_feature': 'i3d', 'collection': 'Youcook2', 'map_size': 32, 'clip_scale_w': 0.7, 'frame_scale_w': 0.3, 'model_root': '/chenyaofo/chenchuanshen/workspace/HLFormer/prvr_model/Youcook2/HLFormer', 'ckpt_path': '/chenyaofo/chenchuanshen/workspace/HLFormer/prvr_model/Youcook2/HLFormer/ckpt', 'sft_factor': 0.6, 'num_workers': 2, 'no_core_driver': False, 'no_pin_memory': False, 'batchsize': 128, 'lr': 8e-05, 'lr_warmup_proportion': 0.01, 'wd': 0.01, 'margin': 0.2, 'n_epoch': 100, 'max_es_cnt': 10, 'hard_negative_start_epoch': 20, 'hard_pool_size': 20, 'use_hard_negative': False, 'loss_factor': [0.02, 0.04, 0.003, 0.001], 'neg_factor': [0.2, 32, 1], 'curv_init': 1, 'learn_curv_bool': True, 'lorentz_dim': 127, 'eval_query_bsz': 50, 'eval_context_bsz': 100, 'max_desc_l': 120, 'max_ctx_l': 128, 'sub_feat_size': 768, 'q_feat_size': 1024, 'max_position_embeddings': 300, 'hidden_size': 384, 'n_heads': 4, 'input_drop': 0.25, 'drop': 0.25, 'initializer_range': 0.02, 'attention_num': 8, 'pin_memory': True, 'caption_rate': 0.0, 'global_caption': False, 'local_hinge_weight': 0.9, 'local_margin': 0.2, 'global_soft_pos_weight': 0.9, 'soft_pos_margin': 0.1, 'query_or_caption': 3}
2025-10-29 22:07:47,621 - INFO - Loading Data ......
2025-10-29 22:07:47,726 - INFO - Loading Model ......
